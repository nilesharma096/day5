<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NiluKicks - Your Shopping Cart</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.css" rel="stylesheet" type="text/css" />
  <link rel="icon" href="favicon.ico" />
  <meta name="description" content="Review and manage your shopping cart at NiluKicks. Adjust quantities, remove items, and proceed to checkout." />
  <meta name="keywords" content="shopping cart, cart review, checkout, online shopping, NiluKicks" />
  <meta property="og:title" content="NiluKicks - Your Shopping Cart" />
  <meta property="og:description" content="Review and manage your shopping cart before checkout at NiluKicks." />
  <meta property="og:image" content="img/social-share-shoes.jpg" />
  <meta property="og:url" content="https://yourusername.github.io/your-repo-name/cart.html" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@yourtwitterhandle" />
  <meta name="twitter:title" content="NiluKicks - Your Shopping Cart" />
  <meta name="twitter:description" content="Review and manage your shopping cart at NiluKicks." />
  <meta name="twitter:image" content="img/social-share-shoes.jpg" />
  <style>
    /* Custom styles for smooth transitions and dark mode adjustments */
    html {
      transition: background-color 0.3s, color 0.3s;
    }
  </style>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXX'); // Replace G-XXXXXXX
  </script>
</head>
<body class="flex flex-col min-h-screen bg-gray-50 text-gray-800 font-sans transition-colors duration-300 dark:bg-gray-900 dark:text-gray-100" data-theme="light">
  <header class="bg-indigo-700 text-white sticky top-0 z-50 shadow-md">
    <nav class="container mx-auto p-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-extrabold hover:text-indigo-300">NiluKicks</a>
      <button id="menuButton" class="lg:hidden btn btn-ghost text-white" aria-label="Toggle Menu" aria-expanded="false">
        <svg class="w-6 h-6 fill-current" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
      <ul id="navLinks" class="hidden lg:flex space-x-6 text-lg items-center">
        <li class="relative w-full max-w-lg">
            <input type="text" placeholder="Search for shoes..." class="input input-sm input-bordered bg-white text-gray-800 rounded-full pl-4 pr-10 focus:outline-none focus:ring-2 focus:ring-indigo-300 w-full" id="search-input-desktop" />
            <button class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-500">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
            </button>
        </li>
        <li><a href="index.html" class="hover:text-indigo-300 text-white">Home</a></li>
        <li><a href="product.html" class="hover:text-indigo-300 text-white">Shop</a></li>
        <li><a href="portfolio.html" class="hover:text-indigo-300 text-white">Portfolio</a></li>
        <li><a href="contact.html" class="hover:text-indigo-300 text-white">Contact</a></li>
        <li>
            <a href="cart.html" id="view-cart-btn-desktop" class="btn btn-ghost text-white flex items-center font-semibold underline">
                <svg class="w-5 h-5 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.5 14 6.333 14H15a1 1 0 000-2H6.333a.834.834 0 01-.629-.295L4.75 9.184V9.18l-1.5-6H3V1z"></path><path d="M6 14a2 2 0 100 4 2 2 0 000-4zm7 0a2 2 0 100 4 2 2 0 000-4z"></path></svg>
                Cart (<span id="cart-count-desktop">0</span>)
            </a>
        </li>
        <li>
          <button id="darkModeToggle" aria-label="Toggle Dark Mode"
            class="ml-4 p-2 rounded bg-indigo-600 hover:bg-indigo-800 transition-colors"
            title="Toggle Dark Mode">ðŸŒ™</button>
        </li>
      </ul>
    </nav>
    <div id="mobileMenu" class="lg:hidden bg-indigo-700 text-white hidden flex-col px-6 pb-6 space-y-4">
      <a href="index.html" class="block py-2 hover:text-indigo-300">Home</a>
      <a href="product.html" class="block py-2 hover:text-indigo-300">Shop</a>
      <a href="portfolio.html" class="block py-2 hover:text-indigo-300">Portfolio</a>
      <a href="contact.html" class="block py-2 hover:text-indigo-300 text-white">Contact</a>
      <div class="relative w-full">
        <input type="text" placeholder="Search..." class="input input-sm input-bordered bg-white text-gray-800 rounded-full w-full pl-4 pr-10 focus:outline-none focus:ring-2 focus:ring-indigo-300" id="search-input-mobile" />
        <button class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-500">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
        </button>
      </div>
      <a href="cart.html" id="view-cart-btn-mobile" class="btn btn-ghost text-white flex items-center justify-start font-semibold underline">
        <svg class="w-5 h-5 mr-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.5 14 6.333 14H15a1 1 0 000-2H6.333a.834.834 0 01-.629-.295L4.75 9.184V9.18l-1.5-6H3V1z"></path><path d="M6 14a2 2 0 100 4 2 2 0 000-4zm7 0a2 2 0 100 4 2 2 0 000-4z"></path></svg>
        Cart (<span id="cart-count-mobile">0</span>)
      </a>
      <button id="darkModeToggleMobile" aria-label="Toggle Dark Mode"
        class="w-full p-2 rounded bg-indigo-600 hover:bg-indigo-800 transition-colors text-center"
        title="Toggle Dark Mode">ðŸŒ™</button>
    </div>
  </header>
  <main class="flex-grow container mx-auto p-8 bg-white rounded-lg shadow-lg max-w-screen-2xl mt-12 transition-colors duration-300 dark:bg-gray-800">
    <h1 class="text-4xl font-extrabold text-indigo-700 dark:text-indigo-300 mb-8 text-center">Your Shopping Cart</h1>

    <div id="cart-content" class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <div class="lg:col-span-2">
        <div id="cart-items-list" class="space-y-6">
          <p id="empty-cart-message-page" class="text-gray-600 dark:text-gray-400 text-center text-xl py-10">Your cart is empty.</p>
        </div>
      </div>

      <div class="lg:col-span-1 bg-gray-100 dark:bg-gray-700 p-6 rounded-lg shadow-md sticky top-28 h-fit">
        <h2 class="text-2xl font-bold text-indigo-700 dark:text-indigo-300 mb-6">Order Summary</h2>
        <div class="flex justify-between items-center mb-4">
          <span class="text-lg">Subtotal (<span id="summary-item-count">0</span> items):</span>
          <span class="text-lg font-semibold" id="summary-subtotal">$0.00</span>
        </div>
        <div class="flex justify-between items-center mb-4">
          <span class="text-lg">Estimated Shipping:</span>
          <span class="text-lg font-semibold" id="summary-shipping-cost">$0.00</span>
        </div>
        <div class="border-t border-gray-300 dark:border-gray-600 pt-4 mt-4 flex justify-between items-center">
          <span class="text-2xl font-bold">Total:</span>
          <span class="text-3xl font-extrabold text-indigo-600 dark:text-indigo-400" id="summary-total">$0.00</span>
        </div>
        <button id="proceed-to-checkout-btn" class="w-full mt-8 btn btn-primary btn-lg">Proceed to Checkout</button>
        <a href="index.html" class="w-full mt-4 btn btn-outline btn-lg">Continue Shopping</a>
      </div>
    </div>
  </main>

  <div id="toast-container" class="fixed top-4 right-4 z-[999] flex flex-col items-end space-y-2"></div>

  <div id="cookie-consent-banner" class="fixed bottom-0 left-0 right-0 bg-gray-900 text-white p-4 flex flex-col md:flex-row items-center justify-between z-[100] transform translate-y-full transition-transform duration-500">
    <p class="text-sm text-center md:text-left mb-2 md:mb-0">
      This site uses cookies to ensure you get the best experience. By continuing to use our site, you agree to our <a href="#" class="underline hover:text-indigo-300 text-white">Cookie Policy</a>.
    </p>
    <div class="flex space-x-2">
      <button id="accept-cookies-btn" class="btn btn-sm btn-primary">Accept</button>
      <button id="decline-cookies-btn" class="btn btn-sm btn-ghost">Decline</button>
    </div>
  </div>

  <footer class="mt-auto bg-indigo-700  text-center p-4 transition-colors duration-300">
    <p class="text-white">Â© 2025 NiluKicks. All rights reserved.
         |
        <a href="portfolio.html" class="hover:underline text-white">Portfolio</a> |
        <a href="contact.html" class="hover:underline text-white">Contact</a> |
        <a href="#" class="hover:underline text-white">Privacy Policy</a> |
        <a href="#" class="hover:underline text-white">Terms & Conditions</a>
    </p>
  </footer>

  <script type="module" src="js/shared.js"></script>
  <script type="module">
    import { getCart, saveCart, removeFromCart, updateCartItemQuantity, updateCartDisplay, showToastNotification } from './js/shared.js';
    import { getCartItemsWithDetails, PRODUCTS } from './js/product-data.js';

    const cartItemsList = document.getElementById('cart-items-list');
    const emptyCartMessagePage = document.getElementById('empty-cart-message-page');
    const summaryItemCount = document.getElementById('summary-item-count');
    const summarySubtotal = document.getElementById('summary-subtotal');
    const summaryShippingCost = document.getElementById('summary-shipping-cost');
    const summaryTotal = document.getElementById('summary-total');
    const proceedToCheckoutBtn = document.getElementById('proceed-to-checkout-btn');

    const SHIPPING_COST_FLAT = 10.00; // Example flat shipping cost

    function renderCartPage() {
        const cart = getCart();
        const cartDetails = getCartItemsWithDetails(cart);

        cartItemsList.innerHTML = '';
        let subtotal = 0;
        let totalItems = 0;

        if (cartDetails.length === 0) {
            emptyCartMessagePage.style.display = 'block';
        } else {
            emptyCartMessagePage.style.display = 'none';
            cartDetails.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                totalItems += item.quantity;

                const cartItemHTML = `
                    <div class="card card-side bg-base-100 shadow-xl p-4 flex-col sm:flex-row items-center sm:items-start gap-4">
                        <figure class="w-32 h-32 flex-shrink-0">
                            <img src="${item.image}" alt="${item.name}" class="w-full h-full object-cover rounded-lg" />
                        </figure>
                        <div class="card-body p-0 flex-grow text-center sm:text-left">
                            <h2 class="card-title text-2xl">${item.name}</h2>
                            <p class="text-gray-600 dark:text-gray-400">Brand: ${item.brand}</p>
                            <p class="text-gray-600 dark:text-gray-400">Size: ${item.selectedSize}</p>
                            <div class="flex items-center justify-center sm:justify-start gap-4 mt-4">
                                <p class="text-xl font-bold text-indigo-600 dark:text-indigo-400">$${item.price.toFixed(2)}</p>
                                <div class="flex items-center border border-gray-300 dark:border-gray-600 rounded-lg">
                                    <button class="btn btn-sm btn-ghost decrease-quantity-page" data-id="${item.id}" data-size="${item.selectedSize}">-</button>
                                    <input type="number" value="${item.quantity}" min="1" class="input input-ghost w-16 text-center appearance-none-none quantity-input-page" data-id="${item.id}" data-size="${item.selectedSize}" />
                                    <button class="btn btn-sm btn-ghost increase-quantity-page" data-id="${item.id}" data-size="${item.selectedSize}">+</button>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col items-center sm:items-end justify-between h-full gap-2 mt-4 sm:mt-0">
                            <p class="text-2xl font-bold text-right">$${itemTotal.toFixed(2)}</p>
                            <button class="btn btn-error btn-sm remove-from-cart-page-btn" data-id="${item.id}" data-size="${item.selectedSize}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                                Remove
                            </button>
                        </div>
                    </div>
                `;
                cartItemsList.innerHTML += cartItemHTML;
            });
        }

        const shippingCost = cartDetails.length > 0 ? SHIPPING_COST_FLAT : 0;
        const grandTotal = subtotal + shippingCost;

        summaryItemCount.textContent = totalItems;
        summarySubtotal.textContent = `$${subtotal.toFixed(2)}`;
        summaryShippingCost.textContent = `$${shippingCost.toFixed(2)}`;
        summaryTotal.textContent = `$${grandTotal.toFixed(2)}`;

        // Disable checkout button if cart is empty
        proceedToCheckoutBtn.disabled = cartDetails.length === 0;

        // Add event listeners for quantity buttons and remove buttons
        cartItemsList.querySelectorAll('.decrease-quantity-page').forEach(button => {
            button.addEventListener('click', (e) => {
                const id = e.currentTarget.dataset.id;
                const size = e.currentTarget.dataset.size;
                const currentItem = cart.find(item => item.id === id && item.selectedSize === size);
                if (currentItem && currentItem.quantity > 1) {
                    updateCartItemQuantity(id, size, currentItem.quantity - 1);
                    renderCartPage(); // Re-render the cart page
                } else if (currentItem && currentItem.quantity === 1) {
                    removeFromCart(id, size);
                    renderCartPage(); // Re-render after removal
                }
            });
        });

        cartItemsList.querySelectorAll('.increase-quantity-page').forEach(button => {
            button.addEventListener('click', (e) => {
                const id = e.currentTarget.dataset.id;
                const size = e.currentTarget.dataset.size;
                const currentItem = cart.find(item => item.id === id && item.selectedSize === size);
                if (currentItem) {
                    const product = PRODUCTS.find(p => p.id === id); // Get product from PRODUCTS array
                    if (product && product.stock && currentItem.quantity < product.stock[size]) {
                        updateCartItemQuantity(id, size, currentItem.quantity + 1);
                        renderCartPage(); // Re-render the cart page
                    } else {
                        showToastNotification(`Max stock reached for ${product.name} (Size: ${size}).`, 'warning');
                    }
                }
            });
        });

        cartItemsList.querySelectorAll('.quantity-input-page').forEach(input => {
            input.addEventListener('change', (e) => {
                const id = e.currentTarget.dataset.id;
                const size = e.currentTarget.dataset.size;
                let newQuantity = parseInt(e.currentTarget.value);

                if (isNaN(newQuantity) || newQuantity < 1) {
                    newQuantity = 1; // Default to 1 if invalid
                    e.currentTarget.value = 1;
                }

                const product = PRODUCTS.find(p => p.id === id);
                if (product && product.stock && newQuantity > product.stock[size]) {
                    showToastNotification(`Only ${product.stock[size]} left in stock for size ${size}. Quantity adjusted.`, 'warning');
                    newQuantity = product.stock[size];
                    e.currentTarget.value = newQuantity;
                }
                
                updateCartItemQuantity(id, size, newQuantity);
                renderCartPage();
            });
        });


        cartItemsList.querySelectorAll('.remove-from-cart-page-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const id = e.currentTarget.dataset.id;
                const size = e.currentTarget.dataset.size;
                removeFromCart(id, size);
                renderCartPage(); // Re-render after removal
            });
        });
    }

    // Event listener for proceeding to checkout
    if (proceedToCheckoutBtn) {
        proceedToCheckoutBtn.addEventListener('click', () => {
            if (getCart().length > 0) {
                window.location.href = 'checkout.html';
            } else {
                showToastNotification('Your cart is empty. Add items before checking out!', 'warning');
            }
        });
    }

    // Initial render on page load
    document.addEventListener('DOMContentLoaded', () => {
        updateCartDisplay(); // Update floating cart count
        renderCartPage(); // Render the main cart page content
    });
  </script>
</body>
</html>